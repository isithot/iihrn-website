---
title: "Is it hot right now?"
---

```{ojs}
//| label: load-map-data
import { aq, op } from "@uwdata/arquero"

bucket_base = "https://isithot-data.s3.ap-southeast-2.amazonaws.com/www/"

FA = FileAttachment
statsObj = FA(bucket_base + "stats/stats_all.json").json()

// stats_all is an object with keys by station id, but we
// need an array with an id field. let's move the ids in
stats = {
  const statsArray = []
  Object.keys(statsObj).map(k => {
    console.log("k: ", k)
    console.log("statsObj[k]:", statsObj[k])
    statsArray.push({...statsObj[k], id: k})}
    )
  return(aq.from(statsArray))
}

// here's the station metadata
places = await aq.loadJSON("locations.json")
places
```

```{ojs}
//| label: draw-map

bertin = require("bertin")

aus_outline = FileAttachment("assets/australia.geojson").json()

bertin.draw({
  params: {},
  layers: [
    {
      type: "layer",
      geojson: places.join(stats).objects(),
      fill: "#1f0754",
      stroke: "#1f0754",
      strokeWidth: 2,
      // symbol: "square",
      symbol_size: 40
    },
    {
      type: "layer",
      geojson: aus_outline,
      fill: "white",
      stroke: "#dddddd",
      strokeWidth: 1.5
    }
  ]
})


```


